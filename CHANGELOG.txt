//$Id$

CCK 6.2-dev
===========

- #296077 Add delta to formatter information.
- #128038 Alter _content_admin_form() to provide the raw widget default values as well as the default value widget so programmed forms will have those values available. You can't tell when you construct the form if it's a programmed form or not, so we will always have to create the default value widget, but we don't always have to use it. This will also get the default values into the Content Copy export in a way that Content Copy import can pick them up, and alter validation to unset the default value widget and skip the default value widget processing if it's a programmed form. Since we are now provided the actual default value (not just the default value widget) in the export, we can safely pick it up in the import.
- #128038 Use content_field_instance_collapse() to send form values in the Content Copy export to be sure we get the original field values for checkboxes instead of the true/false values we will get otherwise.
- #300108 Add group value back to field settings form so it will appear in the Content Copy export.
- #283985 Force Content Copy export to use current field values to avoid storing mangled data back to field.
- #298440 by Moonshine and KarenS: move form permission checking to content_field_form() and don't call hook_widget for users w/out permission.
- #294726 by profix898 and yched: _content_type_info() does not reset on content type changes.
- #293273 Nodereference: update 'referenceable types' when type name changes.
- #295914 Fix additional problems when installing CCK in install profiles.
- #293698 Views integration: make 'show n values starting from m' actually work.
- #295664 Views integration: let summaries display 'allowed values' aliases if any.
- Views integration: prevent empty links for the 'no value' items in summaries.
- #296748 Text: Fix PHP warning when $node->build_mode not set.
- #297915 Fix content_copy.
- #298674 Content copy doesn't import all type properties.
- #293471 Remove fieldgroup selection on field settings form.
- #295556 by CPyle - Userreference: let referenceable users be defined by a View.
- Userreference: Add 'Radios / checkboxes' widget.
- Userref / Noderef : Add a 'none' choice for non-required, single fields with 'Radios / checkboxes' widget.
- #298823 Views integration: do not step into views_* namespace.
- #294797 New $FIELD_NAME_rendered and $GROUP_NAME_rendered variables for node.tpl.php.
- #299698 Userreference: autocompletion query when typed string is '0'.
- #300236 Fix inconsistent schema for 'locked' column between install and updates.
- #292872 Do not delete data for content types defined by disabled modules.
- Do not display 'label' settings on 'advanced' subtab of 'Display fields'.
- #266205 by sun: add zebra classes for field items.
- #299870 Incorrect handling of custom weight for 'Language' node form element.
- Fieldgroups: display options were not supported for 'advanced' contexts (RSS, search index...).
- Fieldgroups: do not display group label when building the search index.
- Nodereference: Allow specific node templates for nodes displayed as values of a noderef field.
- #301736 by nedjo - Nodereference: Multilingual support; if available, propose translations of referenced nodes when creating a new translation.
- Fieldgroups: Remove tinyint (127) limitation on group weights.
- #301984 by joetsuihk - Views Integration: do not display empty divs on empty fields.
- Views integration : prevent possible 'invalid argument for foreach' warnings with 'group multiple values'.
- Fix tests to work with simpletest 2.x.

CCK 6.2.rc6
===========

Hotfix release for:
- #295537 fix warnings in update 6004 when site has no actual cck fields.
Those errors were harmless, no need to worry or run update.php again if you had them.

Minor fix:
- #265795 by smk-ka: formatter labels go through t() twice in Views exposed data.

CCK 6.2.rc5
===========

Main bugs fixed :
- #281388 Optionwidgets: Unselect values doesn't take.
- #286457 Fix menu not being always rebuilt when needed.
- #285138 by quicksketch and yched: Allow CCK to be installed in install profiles.

Main new features :
- #282183 by chx: Nodereference - 'Checkboxes/radios' widget.
- #289138 by dopry: Add support for 'locked' fields (for module-defined fields).

Other changes :
- #273502 Add descriptions to the non-CCK form elements on the Manage fields screen.
- Fix PHP warnings when field display is set to 'hidden' and field is in a fieldgroup.
- Re-introduce '<none>' choice for multiselect widgets (optionwidgets, noderef/userref select).
- #281449 Text: maxlength on textfield widget is 128 even when the field has no maximum length.
- Add tests for optionwidgets.
- #282175: Don't mention 'add more' button when the widget opts out of it.
- Optionwidgets: use '- None -' for 'no selection' option (like core's taxonomy.module).
- #286637 by poiu: clearer example for default value with php-code.
- #93436 Add $form parameter to content_validate.
- #277310 by fractile81: update node object by reference in content_load().
- #285771 Views integration: use the new 'float' filter handler where applicable.
- Fix PHP warnings when renaming a content type.
- #280410 Number: Fix prefix / suffix displayed when field is empty.
- #282937 Fix warnings on uninstall.
- #287540 Add index on nid in data tables, to optimize node deletion (requires update.php)
- #288578 Text: Fix max length to use utf8 length.
- #222214 by aaron, deviantintegral : support tokens for nodererf / userref paths aliases.
- #211306 by asimmonds: Fix error in D5 update with SQL strict mode.
- #292338 by mh89: Set fieldgroup.module's weight to 9 (missing for new D6 installs).
- #292463 Fieldgroup: missing update for fieldgroup table names (didn't actually break anything).
- #292855 by Tgr - Fieldgroup: missing } in query on field instance deletion.
- #292925 by greggles - Text: Fix PHP notice under some circumstances with textarea widget.
- #292675 Support d-n-d reordering of non-cck "fields" for types that have no cck fields.
- #289888 Nodereference: Fix 'full node' and 'teaser' formatters.
- Display field type human names instead of machine names on 'Manage Fields' and 'Fields' overview pages.
- #292884 Better help text for field template suggestions.
- #293163 Use FAPI validation instead of field|widget_settings($op 'validate').
          (the 'validate' op is still supported, though)
- #75423 by mh89 - Text: 'size' setting for textfield widget.


CCK 6.2.rc4
===========

This RC Mainly fixes a critical bug :
http://www.drupal.org/node/277968 - Saving 'Display Fields' wipes widget settings.

- #278325 Nodereference/Userreference - autocomplete widget does not check nodes/users are 'referenceable'.
- #278325 followup: Unify the mechanism used to assign hook_field('validate') errors to form elements across fields and widgets.
- Userreference - Turn the 'Reverse link' radios into a checkbox in the field settings.
- Nodereference - Only list 'node' Views in the 'advanced mode', and differenciate default views as in D5.
- Optionwidgets - fix PHP warning when creating a new 'on/off checkbox' and no allowed values could be set yet.
- Optionwidgets - fix PHP warning on 'on/off checkbox' only one 'allowed value'.
- Optionwidgets - add a 'warning' message to remind the admins they need to set allowed values.
- #278676 by hass: fix untranslated field and widget type names.
- Do not validate the fields settings form when the 'change label / widget' submits the form.
- #273502 Let the 'menu settings' node-form fieldset on node forms be repositioned.
- #273502 followup: add a description for non-CCK 'fields' on 'Manage fields' tab.
- #278793 by hass: fix untranslated PHP code example.
- Nodereference/Userreference - There were two 'no selection' choices on 'select list' widget for non-required fields.
- #277486 Nodereference/Userreference - no selection with 'select list' widget stores 0 instead of NULL.
- #278789 better wording for the 'PHP default value invalid' error message.
- #267771 orignal patch by quicksketch: Richer label settings for views fields.
- #279204 by eMPee584: fix edit paths inconsistency.
- #276990 Nodereference - error message when no valid node with that title (autocomplete widget).
- Widget (FAPI-)validation messages do not display the field 'label' when the error is on a nth value (n > 1).
- Unify field validation error messages.
- #269319 Reintroduce field template variants; add theme instructions text file.
- #179419 by smk-ka: Content Copy - Import fails when language not English.
- #278899 Nodereference - Refactor 'advanced (Views-defined referenceable nodes)' to use views rendering.
- #279190 content_crud_instance_update wiped existing widget settings in some cases.
  Also added a tests for a few basic properties of the CRUD API.

CCK 6.2.rc3
===========
- #278116 by Damien Tournoud: Make some strings easier to translate in views intergration forms.
- #278135 fix some translation quirks + fix french typography for ':' :-)
- Nodereference: 'Title mismatch. Please check your selection' error should break validation (+ fix typo).
- #277968 by jpetso: Fix fatal error when cck folder lives in the main /modules folder.

CCK 6.2.rc2
============
- #276994 Follow up, remove conditional loading for content.views.inc, Views handles it.

CCK 6.2.rc1
============
- #276994 Remove views_include_handlers() from content.views.inc, no longer needed.
- Change 'allow_empty' to 'allow empty' so that Views filters work correctly.
- #272871 Pass #node to formatters to be consistent with the values that were available in the D5 version.
- #271294 Add TODO to get rid of content_write_record() once drupal_write_record() is patched.
- #271294 Add documentation for the reason for having a custom version of drupal_write_record.
- Avoid E_All error when prefixes and suffixes are not defined in number module.
- Avoid E_All error, don't try to return $item[0] if there are no items.
- #266590 Make sure a view is valid before trying to use it in the nodereference module to fix upgrade errors when the view has not been updated to Views 2.
- #258127 Get rid of content_menu_needs_rebuild() in remaining places and only rebuild the menu when absolutely needed.
- Alter content_types_install() to make sure it picks up all the regular field and widget values out of the database. Some of the field values were missing, which caused some of the other values to get set incorrectly during updates and when modules are enabled.
- #235063 Fix jumbled multiple values when hitting the 'add-more' button with more than 10 values.
          Keep 'add more' button text consistent.
- #270014 by yang_yi_cn: form for multiple values didn't call the right hook_widget
- fix 'Undefined index: #access' notice when content_permissions.module is disabled
- #270315 Mention dependency on schema.module in the desciptions of the CRUD tests.
- #227951 by pwolanin: Add a permission for PHP 'default values' and 'allowed values'
- #271682 by pwolanin: Make simpletests easier by not duplicating field name in same form.
- #270315 by pwolanin: Update simpletest to use DrupalWebTestCase.
- #227951 by pwolanin: Add permission for ability to use php code for default values and allowed values.
- #270827 by pwolanin: Validity checks for the AHAH-'add more' request.
- #271087 Properly handle values '0' for text and number fields.
- #258407 Fix field template name to allow for easy overridability.
- #274038 by jpetso: Fix non-JS mode for 'add more' button.
- #275192 by jpetso: Attach AHAH behaviors to newly inserted widgets on JS 'add more'.
- #271710 by pwolanin: tests for UI field CRUD, and node form generation.
- #266696 by pwolanin: Unable to change the label or widget type for a field.
- #201329 by pwolanin and yched: Fix content_field_instance_delete() not cleaning tables.
- #271577 by pwolanin: Fix unsanitized text (optionwidgets, number, text, field labels, field descriptions)
- #273539 by jpetso: Fix JS-'add more' for complex widgets (e.g. filefield)
- #227435 by pwolanin: Usability - Put fields links on content type overview page
- #277101: Hide fieldset-based fieldgroups when all fields empty
- #198508: Prevent data loss for disabled fields.

CCK 6.2.beta
============

Content Generate (new feature)
- #257874 and #187599 provide a way to auto-generate field content for the devel module.
- #261633 E_All fix for content_generate.

Usability
- #227439, #227437, #227945 Rework field and widget type handling to simplify the intial screen when choosing a field and widget type by making it a two-step process where you see only the widgets that apply to the field. Move the setting of the field label to the same place where you set the field name. Change the field edit screen to keep it from showing all the different widgets again and instead just display the current widget. Then add a button to change the widget which will take you to another screen to make the change since the rest of the page will need to change when the widget changes. Keep the changes to the widget label  in that separate process, too, since that affects the menu tabs that need to be changed before redirecting back to the main page.

Update processing
- #256141 Add old updates back to fieldgroup.install for situations where the module was briefly enabled and then disabled and never used so the update process doesn't throw an error for the missing updates.
- Fix potential E_All error in userreference after update.
- Fix E_All error that can come up after update if text module is using format column.
- Change the check in _content_type_info to be sure the new 'active' column exists before trying to query the table during installation and updates. Also fix E_All notice for non-existant db_columns during install and update.
- #237585 Try to avoid foreach errors on missing content type information by creating empty arrays in content_info.

Optionwidgets
- #224391 Get default values working again for optionwidgets.
- #251157 Make sure optionwidgets selections are not lost when previewing node.
- #253038 Make sure empty optionwidget values are always arrays.

Nodereference
- #264345 Create a nodereference wrapper for setting and rendering a view and store the rendered view in a static variable to ensure the same view is not rendered over and over in the same session.
- #263936 Make sure nodereference select views do not try to use paging and do not limit the items per page.
- Clean up autocomplete handling that uses Views as a selector.
- #262112 Add missing hook_theme definition for the plain formatter.
- #256440 Nodereference was passing wrong object to Views for the Views node selection option. Also need to limit available views to those that have fields defined so we can add the title to the view and so there is something meaningful to display in the select list.

Views Integration
- #264479 Make sure we don't try to init() a view for fields that don't have one selected.
- #263936 Set arguments in execute_display. Also make sure to pass $string and $exact_string to the view.
- #257566 Move all content fields into a single group in the Views UI.
- #242856 Make sure the node.nid is aliased when creating our grouped fields query so the parent node isn't confused with nodereference's nid column.
- #261528 Add in missing code to create the link to the node if that option is requested.

Content Copy
- #225664 Make sure groups get imported as well as fields.

Formatters
- #264768 Make sure handling for all possible states of #single is properly set up.
- #260253 $node->type isn't always set, and if missing the formatters that use $fields($field_name, $type_name) to retrieve the field array end up with an empty value. Add the node type to all content fields views so we can be sure it's available and alter the content_format logic to look for the node type both at $node->type and at $node->node_type, where Views will put it, to properly set the content type.

General
- #256116 Add a TODO to reconsider handling of CCK data when a content type is deleted.
- Small fix to content_generate to get auto-generation of number values working.
- #265334 Avoid format error messages in the unusual case where you have created CCK content and then delete the content type without deleting the node, since core does not delete the nodes in that case.
- #227256 Add an additional check when creating a new field that the length is no more than 32 characters.
- #260253 When content_type is set but empty, nothing is returned from content_fields(). Fix that by checking for empty() instead of isset(). This is a more general problem that should be fixed in content_fields().
- #258127 Eliminate need to defer the rebuild of the menu, also adding TODO to see if content_menu_needs_rebuild() can be eliminated.
- #257304 Make sure the widget description is never NULL to avoid problems when a NULL value gets wrapped with t().
- #259704 Make sure help text always appears.
- #255113 Make sure empty filtered text fields don't pick up unintended values from check_plain().
